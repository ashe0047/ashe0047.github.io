{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": "COVID-19 Mortality Rate in SouthEast Asia",
    "width": "container",
    "height": 650,
    "projection": {
        "type":"equirectangular",
        "center":[117.892652,8],
        "scale":1000
    },
    "layer": [
        
    {
        "data": {
            "url": "./data/ne_110m.topojson",
            "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
            },
        "transform": [
            {
              "lookup": "properties.NAME",
              "from": {
                "data": {
                  "url": "./data/owid-covid-data.csv"
                },
                "key": "location",
                "fields": ["total_deaths_per_million", "location"]
              }
            },
            {
                "calculate": "datum.total_deaths_per_million", "as": "Total Deaths Per Million Population"
            }
          ],
        "layer": [
            {
                "data":{
                    "url": "./data/ne_110m.topojson",
                    "format":{"type":"topojson", "feature": "ne_110m_ocean"}
                }, 
                "mark":{"type":"geoshape", "fill":"lightgray"}
            },
                      
            {"mark": {"type": "geoshape", "stroke":"white"}, 
            "encoding": {"color": {
                "field": "Total Deaths Per Million Population",
                "type": "quantitative",
                "scale": {"type": "ordinal", "range":["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"]}
                },
                "tooltip": [
                {"field": "location", "type": "nominal", "title": "Country"},
                {"field": "Total Deaths Per Million Population", "type": "quantitative"}
                ]}},
            {
            "mark":{"type": "text", "size":15, "dy":-10, "fontWeight":"bold"},
            "encoding": {
                "text":{"condition":{"test": "datum.location !== null", "field":"location", "type": "nominal"}},
                "longitude": {"field": "properties.LABEL_X", "type": "quantitative"},
                "latitude": {"field": "properties.LABEL_Y", "type": "quantitative"}
                }
            }
    ]
        },
    {
        "data": {
            "graticule": {"step": [30,30]}
            },
        "mark": {"type": "geoshape", "stroke":"grey","strokeOpacity":0.2}

    }
    
]
  }